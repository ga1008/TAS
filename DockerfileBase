# 1. 使用基于 Debian 12 (Bookworm) 的稳定版镜像
#    (它有 /etc/apt/sources.list 文件)
FROM python:3.12-slim
#FROM lanshare_base

# 2. (优化) 将换源、更新、安装、清理合并到一层
RUN echo "deb http://mirrors.ustc.edu.cn/debian/ bookworm main" > /etc/apt/sources.list \
    && apt-get update && apt-get install -y \
    build-essential \
    && rm -rf /var/lib/apt/lists/*

# 3. 设置工作目录
WORKDIR /app

# 4. (优化) 先复制 requirements.txt 并安装依赖
#    (您添加的清华源非常好，予以保留)
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
