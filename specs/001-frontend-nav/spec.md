# Feature Specification: 前端导航架构重构 (Frontend Navigation Restructure)

**Feature Branch**: `001-frontend-nav`
**Created**: 2025-01-21
**Status**: Draft
**Input**: User description: "根据项目已有的功能，先规范前端菜单栏、顶栏的功能按钮和对应页面的对照关系，具体要求如下：1. 根据后端以及具体页面的功能，反推菜单栏的布局设计，要求合理、美观； 2. 新建仪表盘页面，即首页，原来的首页内容是批改任务列表，将其转移到另外的页面（批改任务）； 3. 现有的顶栏功能混乱，请根据每个页面的具体功能设计合理的顶栏，布局合理且美观的跳转按钮"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 仪表盘首页概览 (Priority: P1)

教师登录系统后，首先看到一个新的仪表盘首页，能够快速了解系统整体状态和常用功能入口，而不是直接看到批改任务列表。

**Why this priority**: 首页是用户进入系统的第一印象，应该提供全局概览而非特定功能，这是用户最核心的导航体验。

**Independent Test**: 用户登录后能够看到一个全新的仪表盘页面，展示统计信息和快捷入口，而非之前的班级卡片列表。

**Acceptance Scenarios**:

1. **Given** 用户已登录系统，**When** 用户访问首页 (`/`)，**Then** 显示仪表盘概览页面，包含以下内容:
   - 统计卡片：班级总数、学生总数、批改核心数量、待处理任务数
   - 快捷操作入口：新建班级、生成批改核心、导入学生名单
   - 最近活动：最近的批改任务、最近生成的核心
2. **Given** 用户在仪表盘首页，**When** 用户点击"批改任务"快捷入口，**Then** 跳转到批改任务列表页面（原首页内容）

---

### User Story 2 - 批改任务管理 (Priority: P1)

用户可以查看和管理所有批改任务（班级），原首页的班级卡片列表迁移到独立的"批改任务"页面。

**Why this priority**: 批改任务是系统的核心功能，将原首页内容迁移到独立页面后，用户可以更专注于班级管理和批改操作。

**Independent Test**: 用户通过侧边栏"批改任务"菜单进入页面，看到原有的班级卡片列表，可以正常进行班级管理操作。

**Acceptance Scenarios**:

1. **Given** 用户已登录系统，**When** 用户点击侧边栏"批改任务"菜单，**Then** 显示班级列表页面，包含:
   - 班级卡片网格（原首页内容）
   - 班级名称、课程名称、批改策略
   - 空状态引导（新建班级、生成核心）
2. **Given** 用户在批改任务页面，**When** 用户点击某个班级卡片，**Then** 进入该班级的批改详情页面

---

### User Story 3 - 规范化侧边栏菜单 (Priority: P2)

侧边栏菜单按照功能区域重新组织，提供清晰的导航层级和图标标识。

**Why this priority**: 清晰的菜单结构帮助用户快速定位功能，提升整体使用体验。

**Independent Test**: 用户可以通过侧边栏菜单快速访问所有功能，菜单分类合理，图标直观。

**Acceptance Scenarios**:

1. **Given** 用户已登录系统，**When** 用户查看侧边栏，**Then** 菜单按以下结构组织:
   - **概览**: 仪表盘
   - **批改管理**: 批改任务、新建班级
   - **AI 工具**: 生成核心、核心列表
   - **资源管理**: 学生名单、文档库、文件管理
   - **系统**: 教务系统同步、管理员后台
2. **Given** 用户查看菜单，**When** 鼠标悬停在菜单项上，**When** 菜单项有悬停效果和图标动画

---

### User Story 4 - 上下文相关顶栏 (Priority: P2)

顶栏根据当前页面显示不同的操作按钮，提供与当前页面上下文相关的快捷操作。

**Why this priority**: 上下文相关的顶栏提升用户操作效率，减少页面跳转。

**Independent Test**: 用户在不同页面看到不同的顶栏操作按钮，按钮与页面功能高度相关。

**Acceptance Scenarios**:

1. **Given** 用户在仪表盘页面，**When** 用户查看顶栏，**Then** 显示刷新按钮和通知中心
2. **Given** 用户在批改任务列表页面，**When** 用户查看顶栏，**Then** 显示"新建班级"按钮和搜索框
3. **Given** 用户在批改详情页面，**When** 用户查看顶栏，**Then** 显示"返回批改任务"、"导出成绩"、"清空数据"、"删除班级"按钮
4. **Given** 用户在生成核心页面，**When** 用户查看顶栏，**Then** 显示"查看核心列表"按钮

---

### User Story 5 - 面包屑导航 (Priority: P3)

在深层级页面添加面包屑导航，帮助用户了解当前位置并快速返回上级页面。

**Why this priority**: 面包屑导航提升多层页面的可导航性，但优先级低于核心功能重构。

**Independent Test**: 用户在批改详情、学生详情等页面能看到面包屑导航，点击可返回上级。

**Acceptance Scenarios**:

1. **Given** 用户在学生详情页面，**When** 用户查看顶栏左侧，**Then** 显示"仪表盘 > 批改任务 > [班级名称] > [学生姓名]"面包屑
2. **Given** 用户点击面包屑中的任意层级，**When** 用户点击，**Then** 跳转到对应页面

### Edge Cases

- 用户没有任何班级时的空状态展示
- 用户权限不足（非管理员）时的菜单隐藏
- 移动端（屏幕宽度 < 768px）侧边栏默认隐藏，通过汉堡菜单按钮以覆盖层形式显示
- 通知中心大量通知时的展示和分页（超过 10 条显示"查看全部"链接）

## Requirements *(mandatory)*

### Functional Requirements

#### 仪表盘页面
- **FR-001**: 系统必须在首页 (`/`) 显示新的仪表盘页面，包含统计概览
- **FR-002**: 仪表盘必须显示以下统计卡片（会话级缓存，提供手动刷新按钮）:
  - 班级总数（当前用户创建的）
  - 学生总数（所有班级的学生去重）
  - 批改核心数量（可用的批改脚本）
  - 待处理任务数（进行中的 AI 生成任务）
- **FR-003**: 仪表盘必须提供快捷操作入口卡片:
  - 新建班级（跳转到 `/new_class`）
  - 生成批改核心（跳转到 `/ai_generator`）
  - 导入学生名单（跳转到 `/student/import`）
- **FR-004**: 仪表盘必须显示最近活动列表:
  - 最近创建的班级（最多 5 条）
  - 最近生成的批改核心（最多 5 条）
  - 显示时间和操作类型
- **FR-004A**: 新用户空状态：当用户没有任何班级、学生或批改核心时，仪表盘显示欢迎消息和突出的快捷操作入口，隐藏全零统计卡片

#### 批改任务页面
- **FR-005**: 系统必须在 `/tasks` 路由提供批改任务列表页面
- **FR-006**: 批改任务页面显示原首页的班级卡片列表内容
- **FR-007**: 批改任务页面必须包含"新建班级"操作按钮
- **FR-008**: 空状态时显示引导流程和快捷入口

#### 侧边栏菜单
- **FR-009**: 侧边栏必须按以下结构组织菜单:
  ```
  概览
    - 仪表盘

  批改管理
    - 批改任务
    - 新建班级

  AI 工具
    - 生成核心
    - 核心列表

  资源管理
    - 学生名单
    - 文档库
    - 文件管理

  系统
    - 教务系统同步
    - 管理员后台
    - 退出登录
  ```
- **FR-010**: 每个菜单项必须有对应的图标（使用 FontAwesome）
- **FR-011**: 当前页面菜单项必须高亮显示（靛蓝背景）
- **FR-012**: 菜单分组必须有清晰的分类标题

#### 顶栏设计
- **FR-013**: 顶栏必须根据当前页面动态显示不同的操作按钮
- **FR-014**: 仪表盘页面顶栏显示: 刷新按钮、通知中心、用户信息
- **FR-015**: 批改任务列表页面顶栏显示: "新建班级"按钮、搜索框、通知中心
- **FR-016**: 批改详情页面顶栏显示: 面包屑导航、返回按钮、"导出成绩"、"清空数据"、"删除班级"按钮
- **FR-017**: AI 生成页面顶栏显示: "查看核心列表"按钮、通知中心
- **FR-018**: 核心列表页面顶栏显示: "生成新核心"按钮、搜索框
- **FR-019**: 学生名单页面顶栏显示: "导入学生"按钮、搜索框
- **FR-020**: 文档库页面顶栏显示: "上传文档"按钮、筛选器

#### 面包屑导航
- **FR-021**: 深层级页面（批改详情、学生详情、核心详情）必须显示面包屑
- **FR-022**: 面包屑必须使用格式: 一级 > 二级 > 三级
- **FR-023**: 面包屑每一级必须可点击返回对应页面
- **FR-024**: 面包屑当前位置（最后一级）不可点击，显示为普通文本

#### 路由调整
- **FR-025**: 原 `/` 路由的班级列表内容迁移到 `/tasks`，`/` 变更为新的仪表盘页面
- **FR-026**: 提供路由重定向支持，确保原有指向 `/` 的书签能正常访问（显示新的仪表盘）
- **FR-027**: 侧边栏"仪表盘"菜单项链接到 `/`，"批改任务"菜单项链接到 `/tasks`

#### 设计规范
- **FR-028**: 所有页面必须遵循 `templates/FRONTEND_GUIDE.md` 定义的设计规范
- **FR-029**: 侧边栏使用固定定位 + 毛玻璃效果，默认展开状态，提供展开/收起切换按钮
- **FR-030**: 顶栏使用固定顶部 + 毛玻璃效果
- **FR-031**: 所有按钮必须有悬停和点击反馈动画

### Key Entities

- **统计卡片 (Stats Card)**: 显示统计数字和标签，带图标和渐变背景
- **快捷入口 (Quick Action)**: 卡片式快捷操作按钮，包含图标、标题、描述
- **活动条目 (Activity Item)**: 显示最近操作记录，包含时间、类型、相关对象
- **面包屑节点 (Breadcrumb Node)**: 表示导航层级，包含标题和链接

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 用户登录后 3 秒内能够看到仪表盘页面完全加载
- **SC-002**: 用户可以通过侧边栏在 2 次点击内到达任何功能页面
- **SC-003**: 用户在批改详情页面可以通过顶栏按钮直接完成 80% 的常用操作
- **SC-004**: 新用户首次使用时，能够通过仪表盘快捷入口完成首次班级创建流程
- **SC-005**: 侧边栏菜单项不超过 2 层嵌套，所有功能在 3 次点击内可达
- **SC-006**: 面包屑导航准确反映当前页面位置，支持快速返回上级

## Clarifications

### Session 2025-01-21

- **Q**: 仪表盘统计数据应该多久刷新一次？是否需要缓存？
  **A**: 会话级缓存，按需刷新。统计数据在用户会话期间缓存，提供手动刷新按钮，避免每次加载都查询数据库
- **Q**: 仪表盘页面应该使用根路由 `/` 还是独立路由 `/dashboard`？
  **A**: 仪表盘使用根路由 `/`，批改任务列表迁移到 `/tasks`。这是最常见的首页模式，也符合用户的直觉预期
- **Q**: 侧边栏默认应该是展开还是收起状态？
  **A**: 默认展开，用户可手动切换。新用户需要看到完整菜单选项以了解系统功能
- **Q**: 移动端侧边栏应该如何表现？
  **A**: 默认隐藏，通过汉堡菜单按钮以覆盖层形式显示。移动设备屏幕空间有限，内容优先
- **Q**: 新用户（无任何数据）的仪表盘应该显示什么？
  **A**: 显示欢迎消息和突出的快捷操作入口，而非全零统计。引导新用户完成首次操作

## Assumptions

1. 用户使用现代浏览器（Chrome、Firefox、Safari、Edge 最新版本）
2. 用户屏幕分辨率不小于 1366x768
3. 用户已熟悉基本的 Web 应用操作（点击、悬停、滚动）
4. 现有的后端路由和 API 保持不变，仅调整前端路由
5. 数据库统计查询可以在 100ms 内完成
6. 用户会话通过 Flask 框架管理
